<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Team & Skills â€” SmartCool Pro Intranet" />
    <meta name="theme-color" content="#3b82f6" />
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <title>Team & RACI | SmartCool Pro</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/team.css" />
    <!-- FontAwesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <script src="js/sidebar.js"></script>
    <script>
      window.si =
        window.si ||
        function () {
          (window.siq = window.siq || []).push(arguments);
        };
    </script>
    <script defer src="/_vercel/speed-insights/script.js"></script>
    <main class="main-content">
      <header>
        <h1>Team & Expertise</h1>
        <p>
          Meet the SmartInnovators behind the Zero-Waste Fridge and their Roles
          (RACI).
        </p>
      </header>

      <!-- Filter Controls -->
      <div class="filter-container">
        <button class="filter-btn active" data-filter="all">All Members</button>
        <button class="filter-btn" data-filter="hardware">Hardware</button>
        <button class="filter-btn" data-filter="software">AI & Software</button>
        <button class="filter-btn" data-filter="management">Management</button>
        <button class="filter-btn" data-filter="design">Design</button>
      </div>

      <div class="card-grid" id="team-grid">
        <!-- Cards will be injected here by JS -->
      </div>

      <!-- RACI Matrix Section -->
      <section class="raci-section">
        <h2 style="margin-bottom: 15px; color: #1e293b">
          RACI Matrix (Responsibility Assignment)
        </h2>
        <p style="color: #64748b; margin-bottom: 20px">
          Defining roles for the T-CEN-500 Industrialization Phase.
        </p>

        <div style="overflow-x: auto">
          <table class="raci-table">
            <thead>
              <tr>
                <th>Deliverable / Task</th>
                <th>Jean Dupont<br /><small>Chef de Projet</small></th>
                <th>Sophie Martin<br /><small>Hardware Lead</small></th>
                <th>Lucas Bernard<br /><small>Cloud Architect</small></th>
                <th>Emma Petit<br /><small>Data Scientist</small></th>
                <th>Thomas Richard<br /><small>Embedded Dev</small></th>
                <th>Julie Dubois<br /><small>Mech Eng</small></th>
                <th>Marc Moreau<br /><small>Acheteur</small></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Project Charter & Scope</td>
                <td class="raci-cell raci-a">A/R</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
              </tr>
              <tr>
                <td>Hardware Schematics & PCB Placement</td>
                <td class="raci-cell raci-a">A</td>
                <td class="raci-cell raci-r">R</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-c">C</td>
              </tr>
              <tr>
                <td>Cloud & Data Pipeline (AWS + MQTT)</td>
                <td class="raci-cell raci-a">A</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-r">R</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
              </tr>
              <tr>
                <td>YOLOv8 Model Training & Dataset</td>
                <td class="raci-cell raci-a">A</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-r">R</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
              </tr>
              <tr>
                <td>Firmware & Edge Integration (RPi5 + Sensors)</td>
                <td class="raci-cell raci-a">A</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-r">R</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
              </tr>
              <tr>
                <td>Mechanical Enclosure & Thermal</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-r">R</td>
                <td class="raci-cell raci-i">I</td>
              </tr>
              <tr>
                <td>Procurement & BOM Freeze</td>
                <td class="raci-cell raci-a">A</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-r">R</td>
              </tr>
              <tr>
                <td>EMC Pre-scan & CE Certification</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-a">A</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-i">I</td>
                <td class="raci-cell raci-r">R</td>
                <td class="raci-cell raci-c">C</td>
                <td class="raci-cell raci-c">C</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="legend">
          <div><span class="raci-r">R</span> Responsible</div>
          <div><span class="raci-a">A</span> Accountable</div>
          <div><span class="raci-c">C</span> Consulted</div>
          <div><span class="raci-i">I</span> Informed</div>
        </div>
      </section>
    </main>

    <script>
      // Fetch Team Data
      fetch("/api/team")
        .then((res) => res.json())
        .then((members) => {
          const grid = document.getElementById("team-grid");
          if (!grid) {
            console.error("team-grid element not found");
            return;
          }
          grid.innerHTML = members
            .map((member) => {
              const skills = member.skills ? (
                typeof member.skills === "string"
                  ? JSON.parse(member.skills)
                  : member.skills
              ) : [];
              const skillsHtml = (skills || [])
                .map(
                  (skill) => `
                        <div class="skill-container">
                            <div class="skill-label"><span>${skill.name || 'N/A'}</span><span>${skill.val || 0}</span></div>
                            <div class="skill-bar-bg"><div class="skill-bar-fill" data-width="${skill.val || 0}" style="width: 0%"></div></div>
                        </div>
                    `
                )
                .join("");

              return `
                    <div class="card" data-category="${member.category || 'other'}">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                            <div style="width: 50px; height: 50px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #64748b;">
                                <i class="fas ${member.icon || 'fa-user'}"></i>
                            </div>
                            <div>
                                <h3>${member.name || 'N/A'}</h3>
                                <p style="color: var(--accent, #2563eb); font-size: 0.9rem; font-weight: 500;">${member.role || 'N/A'}</p>
                            </div>
                        </div>
                        <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 20px;">${member.description || 'N/A'}</p>
                        ${skillsHtml}
                    </div>`;
            })
            .join("");

          // Re-initialize animations and filters
          initInteractions();
        })
        .catch((err) => {
          console.error("Error loading team data:", err);
        });

      function initInteractions() {
        // Filter Functionality
        const filterBtns = document.querySelectorAll(".filter-btn");
        const cards = document.querySelectorAll(".card");

        filterBtns.forEach((btn) => {
          btn.addEventListener("click", () => {
            filterBtns.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            const filterValue = btn.getAttribute("data-filter");

            cards.forEach((card) => {
              if (
                filterValue === "all" ||
                card.getAttribute("data-category") === filterValue
              ) {
                card.style.display = "block";
                card.style.animation = "fadeIn 0.5s forwards";
              } else {
                card.style.display = "none";
              }
            });
          });
        });

        // Skill Bar Animation
        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                const bars = entry.target.querySelectorAll(".skill-bar-fill");
                bars.forEach((bar) => {
                  bar.style.width = bar.getAttribute("data-width");
                  bar.style.transition = "width 1.5s ease-out";
                });
                observer.unobserve(entry.target);
              }
            });
          },
          { threshold: 0.2 }
        );

        cards.forEach((card) => observer.observe(card));
      }
    </script>
  </body>
</html>
