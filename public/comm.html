<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Communications — SmartCool Pro Intranet"
    />
    <meta name="theme-color" content="#3b82f6" />
    <title>Communications | SmartCool Pro</title>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>
  <body>
    <script src="js/sidebar.js"></script>
    <script>
      window.si =
        window.si ||
        function () {
          (window.siq = window.siq || []).push(arguments);
        };
    </script>
    <script defer src="/_vercel/speed-insights/script.js"></script>
    <main class="main-content">
      <header>
        <h1><i class="fas fa-bullhorn" style="color: var(--accent); margin-right: 10px;"></i>Communications</h1>
        <p>Official project communications and reports.</p>
      </header>

      <div id="comms-container" style="display: grid; gap: 20px; max-width: 800px; margin: 0 auto;">
        <!-- Comms injected here -->
      </div>
    </main>

    <script>
      fetch('/api/comms')
        .then(res => res.json())
        .then(comms => {
            const container = document.getElementById('comms-container');
            container.innerHTML = comms.map(comm => `
                <div class="card" style="border-left: 4px solid ${comm.type === 'Internal' ? '#3b82f6' : '#10b981'};">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <div style="width: 40px; height: 40px; background: #f1f5f9; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                                <i class="fas ${comm.icon || 'fa-envelope'}" style="color: #64748b;"></i>
                            </div>
                            <div>
                                <h3 style="margin: 0; font-size: 1.1rem;">${comm.subject}</h3>
                                <p style="margin: 0; font-size: 0.85rem; color: #64748b;">
                                    <span style="font-weight: 600;">${comm.type}</span> • From: ${comm.sender} • To: ${comm.recipient}
                                </p>
                            </div>
                        </div>
                    </div>
                    <div style="background: #f8fafc; padding: 15px; border-radius: 8px; font-size: 0.95rem; line-height: 1.6; color: #334155;">
                        ${comm.content}
                    </div>
                </div>
            `).join('');
        })
        .catch(err => console.error(err));
    </script>
  </body>
</html>
